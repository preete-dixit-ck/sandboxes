CIS Red Hat Enterprise Linux Benchmark v2.1.1:
  1 Install Updates, Patches and Additional Security Software:
    1.1 Filesystem Configuration:
      1.1.1 Disable unused filesystems:
        1.1.1.1 Ensure mounting of cramfs filesystems is disabled - Level 1 Server (Scored):
          audit:
            - "/sbin/modprobe -n -v cramfs | grep /bin/true"
            - "/sbin/lsmod | grep cramfs | wc -l | grep ^0"
          expected:
            - 0
            - 0
        1.1.1.2 Ensure mounting of freevxfs filesystems is disabled - Level 1 Server (Scored):
          audit:
            - "/sbin/modprobe -n -v freevxfs | grep /bin/true"
            - "/sbin/lsmod | grep freexvfs | wc -l | grep ^0"
          expected:
            - 0
            - 0
        1.1.1.3 Ensure mounting of jffs2 filesystems is disabled - Level 1 Server (Scored):
          audit:
            - "/sbin/modprobe -n -v jffs2 | grep /bin/true"
            - "/sbin/lsmod | grep jffs2 | wc -l | grep ^0"
          expected:
            - 0
            - 0
        1.1.1.4 Ensure mounting of hfs filesystems is disabled - Level 1 Server (Scored):
          audit:
            - "/sbin/modprobe -n -v hfs | grep /bin/true"
            - "/sbin/lsmod | grep hfs | wc -l | grep ^0"
          expected:
            - 0
            - 0
        1.1.1.5 Ensure mounting of hfsplus filesystems is disabled - Level 1 Server (Scored):
          audit:
            - "/sbin/modprobe -n -v hfsplus | grep /bin/true"
            - "/sbin/lsmod | grep hfsplus | wc -l | grep ^0"
          expected:
            - 0
            - 0
        1.1.1.6 Ensure mounting of squashfs filesystems is disabled - Level 1 Server (Scored):
          audit:
            - "/sbin/modprobe -n -v squashfs | grep /bin/true"
            - "/sbin/lsmod | grep squashfs | wc -l | grep ^0"
          expected:
            - 0
            - 0
        1.1.1.7 Ensure mounting of udf filesystems is disabled - Level 1 Server (Scored):
          audit:
            - "/sbin/modprobe -n -v udf | grep /bin/true"
            - "/sbin/lsmod | grep udf | wc -l | grep ^0"
          expected:
            - 0
            - 0
        1.1.1.8 Ensure mounting of FAT filesystems is disabled - Level 1 Server (Scored):
          audit:
            - "/sbin/modprobe -n -v vfat | grep /bin/true"
            - "/sbin/lsmod | grep vfat | wc -l | grep ^0"
          expected:
            - 0
            - 0
      1.1.2 Ensure separate partition exists for /tmp - Level 2 Server (Scored):
        audit:
          - "mount | grep '[[:space:]]/tmp[[:space:]]'"
        expected:
          - 0
      1.1.3 Ensure nodev option set on /tmp partition - Level 1 Server (Scored):
        audit:
          - "mount | grep '[[:space:]]/tmp[[:space:]]' | grep nodev"
        expected:
          - 0
      1.1.4 Ensure nosuid option set on /tmp partition - Level 1 Server (Scored):
        audit:
          - "mount | grep '[[:space:]]/tmp[[:space:]]' | grep nosuid"
        expected:
          - 0
      1.1.5 Ensure noexec option set on /tmp partition - Level 1 Server (Scored):
        audit:
          - "mount | grep '[[:space:]]/tmp[[:space:]]' | grep noexec"
        expected:
          - 0
      1.1.6 Ensure separate partition exists for /var - Level 2 Server (Scored):
        audit:
          - "mount | grep '[[:space:]]/var[[:space:]]'"
        expected:
          - 0
      1.1.7 Ensure separate partition exists for /var/tmp - Level 2 Server (Scored):
        audit:
          - "mount | grep '[[:space:]]/var/tmp[[:space:]]'"
        expected:
          - 0
      1.1.8 Ensure nodev option set on /var/tmp partition - Level 1 Server (Scored):
        audit:
          - "mount | grep '[[:space:]]/var/tmp[[:space:]]' | grep nodev"
        expected:
          - 0
      1.1.9 Ensure nosuid option set on /var/tmp partition - Level 1 Server (Scored):
        audit:
          - "mount | grep '[[:space:]]/var/tmp[[:space:]]' | grep nosuid"
        expected:
          - 0
      1.1.10 Ensure noexec option set on /var/tmp partition - Level 1 Server (Scored):
        audit:
          - "mount | grep '[[:space:]]/var/tmp[[:space:]]' | grep noexec"
        expected:
          - 0
      1.1.11 Ensure separate partition exists for /var/log - Level 2 Server (Scored):
        audit:
          - "mount | grep '[[:space:]]/var/log[[:space:]]'"
        expected:
          - 0
      1.1.12 Ensure separate partition exists for /var/log/audit - Level 2 Server (Scored):
        audit:
          - "mount | grep '[[:space:]]/var/log/audit[[:space:]]'"
        expected:
          - 0
      1.1.13 Ensure separate partition exists for /home - Level 2 Server (Scored):
        audit:
          - "mount | grep '[[:space:]]/home[[:space:]]'"
        expected:
          - 0
      1.1.14 Ensure nodev option set on /home partition - Level 1 Server (Scored):
        audit:
          - "mount | grep '[[:space:]]/home[[:space:]]' | grep nodev"
        expected:
          - 0
      1.1.15 Ensure nodev option set on /dev/shm partition - Level 1 Server (Scored):
        audit:
          - "mount | grep '[[:space:]]/dev/shm[[:space:]]' | grep nodev"
        expected:
          - 0
      1.1.16 Ensure nosuid option set on /dev/shm partition - Level 1 Server (Scored):
        audit:
          - "mount | grep '[[:space:]]/dev/shm[[:space:]]' | grep nosuid"
        expected:
          - 0
      1.1.17 Ensure noexec option set on /dev/shm partition - Level 1 Server (Scored):
        audit:
          - "mount | grep '[[:space:]]/dev/shm[[:space:]]' | grep noexec"
        expected:
          - 0
      1.1.18 Ensure nodev option set on removable media partitions - Level 1 Server (Not Scored):
        audit:
          - skip
        expected:
          - 0
      1.1.19 Ensure nosuid option set on removable media partitions - Level 1 Server (Not Scored):
        audit:
          - skip
        expected:
          - 0
      1.1.20 Ensure noexec option set on removable media partitions - Level 1 Server (Not Scored):
        audit:
          - skip
        expected:
          - 0
      1.1.21 Ensure sticky bit is set on all world-writable directories - Level 1 Server (Scored):
        audit:
          - "df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type d \\( -perm -0002 -a ! -perm -1000 \\) 2>/dev/null | wc -l | grep ^0"
        expected:
          - 0
      1.1.22 Disable Automounting - Level 1 Server (Scored):
        audit:
          - "systemctl is-enabled autofs | grep enabled"
        expected:
          - 1
    1.2 Configure Software Updates:
      1.2.1 Ensure package manager repositories are configured - Level 1 Server (Not Scored):
        audit:
          - skip
        expected:
          - 0
      1.2.2 Ensure GPG keys are configured - Level 1 Server (Not Scored):
        audit:
          - skip
        expected:
          - 0
      1.2.3 Ensure gpgcheck is globally activated - Level 1 Server (Scored):
        audit:
          - "grep ^gpgcheck=1 /etc/yum.conf | grep gpgcheck=1"
          - "grep ^gpgcheck /etc/yum.repos.d/* | grep gpgcheck=0"
        expected:
          - 0
          - 1
    1.3 Filesystem Integrity Checking:
      1.3.1 Ensure AIDE is installed - Level 1 Server (Scored):
        audit:
          - "rpm -q aide"
        expected:
          - 0
      1.3.2 Ensure filesystem integrity is regularly checked - Level 1 Server (Scored):
        audit:
          - "crontab -u root -l | grep aide || grep -r aide /etc/cron.* /etc/crontab"
        expected:
          - 0
    1.4 Secure Boot Settings:
      1.4.1 Ensure permissions on bootloader config are configured - Level 1 Server (Scored):
        audit:
          - "stat /boot/grub2/grub.cfg | grep 'Access:\\s(0600/-rw-------)'"
          - "stat /boot/grub2/grub.cfg | grep 'Uid:\\s(\\s*0/\\s*root)'"
          - "stat /boot/grub2/grub.cfg | grep 'Gid:\\s(\\s*0/\\s*root)'"
        expected:
          - 0
          - 0
          - 0
      1.4.2 Ensure bootloader password is set - Level 1 Server (Scored):
        audit:
          - "grep '^set superusers' /boot/grub2/grub.cfg | grep 'set superusers'"
          - "grep ^password /boot/grub2/grub.cfg | grep password_pbkdf2"
        expected:
          - 0
          - 0
      1.4.3 Ensure authentication required for single user mode - Level 1 Server (Not Scored):
        audit:
          - skip
        expected:
          - 0
    1.5 Additional Process Hardening:
      1.5.1 Ensure core dumps are restricted - Level 1 Server (Scored):
        audit:
          - "grep 'hard core' /etc/security/limits.conf"
          - "/sbin/sysctl fs.suid_dumpable | grep 'fs.suid_dumpable\\s*=\\s*0'"
        expected:
          - 0
          - 0
      1.5.2 Ensure XD/NX support is enabled - Level 1 Server (Not Scored):
        audit:
          - skip
        expected:
          - 0
      1.5.3 Ensure address space layout randomization (ASLR) is enabled - Level 1 Server (Scored):
        audit:
          - "/sbin/sysctl kernel.randomize_va_space | grep 'kernel.randomize_va_space\\s*=\\s*2'"
        expected:
          - 0
      1.5.4 Ensure prelink is disabled - Level 1 Server (Scored):
        audit:
          - "rpm -q prelink"
        expected:
          - 1
    1.6 Mandatory Access Control:
      1.6.1.1 Ensure SELinux is not disabled in bootloader configuration - Level 2 Server (Scored):
        audit:
          - "grep '^\\s*linux' /boot/grub2/grub.cfg | grep selinux=0"
          - "grep '^\\s*linux' /boot/grub2/grub.cfg | grep enforcing=0"
        expected:
          - 1
          - 1
      1.6.1.2 Ensure the SELinux state is enforcing - Level 2 Server (Scored):
        audit:
          - "grep SELINUX=enforcing /etc/selinux/config"
          - "sestatus | grep 'SELinux status:\\s*enabled'"
          - "sestatus | grep 'Current mode:\\s*enforcing'"
          - "sestatus | grep 'Mode from config file:\\s*permissive'"
        expected:
          - 0
          - 0
          - 0
          - 0
      1.6.1.3 Ensure SELinux policy is configured - Level 2 Server (Scored):
        audit:
          - "grep SELINUXTYPE=targeted /etc/selinux/config"
          - "sestatus | grep 'Loaded policy name:\\s*targeted'"
        expected:
          - 0
          - 0
      1.6.1.4 Ensure SETroubleshoot is not installed - Level 2 Server (Scored):
        audit:
          - "rpm -q setroubleshoot"
        expected:
          - 1
      1.6.1.5 Ensure the MCS Translation Service (mcstrans) is not installed - Level 2 Server (Scored):
        audit:
          - "rpm -q mcstrans"
        expected:
          - 1
      1.6.1.6 Ensure no unconfined daemons exist - Level 2 Server (Scored):
        audit:
          - "ps -eZ | egrep initrc | egrep -vw 'tr|ps|egrep|bash|awk' | tr ':' ' ' | awk '{ print $NF }' | wc -l | grep ^0"
        expected:
          - 0
      1.6.2 Ensure SELinux is installed - Level 2 Server (Scored):
        audit:
          - "rpm -q libselinux"
        expected:
          - 0
    1.7 Warning Banners:
      1.7.1 Command Line Warning Banners:
        1.7.1.1 Ensure message of the day is configured properly - Level 1 Server (Scored):
          audit:
            - "egrep '(\\\\v|\\\\r|\\\\m|\\\\s)' /etc/motd"
          expected:
            - 1
        1.7.1.2 Ensure local login warning banner is configured properly - Level 1 Server (Not Scored):
          audit:
            - "egrep '(\\\\v|\\\\r|\\\\m|\\\\s)' /etc/issue"
          expected:
            - 1
        1.7.1.3 Ensure remote login warning banner is configured properly - Level 1 Server (Not Scored):
          audit:
            - "egrep '(\\\\v|\\\\r|\\\\m|\\\\s)' /etc/issue.net"
          expected:
            - 1
        1.7.1.4 Ensure permissions on /etc/motd are configured - Level 1 Server (Not Scored):
          audit:
            - "stat /etc/motd | grep 'Access:\\s*(0644/-rw-r--r--)'"
            - "stat /etc/motd | grep 'Uid:\\s*(\\s*0/\\s*root)'"
            - "stat /etc/motd | grep 'Gid:\\s*(\\s*0/\\s*root)'"
          expected:
            - 0
            - 0
            - 0
        1.7.1.5 Ensure permissions on /etc/issue are configured - Level 1 Server (Scored):
          audit:
            - "stat /etc/issue | grep 'Access:\\s*(0644/-rw-r--r--)'"
            - "stat /etc/issue | grep 'Uid:\\s*(\\s*0/\\s*root)'"
            - "stat /etc/issue | grep 'Gid:\\s*(\\s*0/\\s*root)'"
          expected:
            - 0
            - 0
            - 0
        1.7.1.6 Ensure permissions on /etc/issue.net are configured - Level 1 Server (Not Scored):
          audit:
            - "stat /etc/issue.net | grep 'Access:\\s*(0644/-rw-r--r--)'"
            - "stat /etc/issue.net | grep 'Uid:\\s*(\\s*0/\\s*root)'"
            - "stat /etc/issue.net | grep 'Gid:\\s*(\\s*0/\\s*root)'"
          expected:
            - 0
            - 0
            - 0
      1.7.2 Ensure GDM login banner is configured if installed - Level 1 Server (Scored):
        # We will make sure gdm is not installed.
        audit:
          - "rpm -q gdm"
        expected:
          - 1
    1.8 Ensure updates, patches, and additional security software are installed - Level 1 Server (Not Scored):
      audit:
        - skip
      expected:
        - 0
  2 Services:
    2.1 inetd Services:
      2.1.1 Ensure chargen services are not enabled - Level 1 Server (Scored):
        # We will make sure xinetd is not installed.
        audit:
          - "rpm -q xinetd"
        expected:
          - 1
      2.1.2 Ensure daytime services are not enabled - Level 1 Server (Scored):
        # We will make sure xinetd is not installed.
        audit:
          - "rpm -q xinetd"
        expected:
          - 1
      2.1.3 Ensure discard services are not enabled - Level 1 Server (Scored):
        # We will make sure xinetd is not installed.
        audit:
          - "rpm -q xinetd"
        expected:
          - 1
      2.1.4 Ensure echo services are not enabled - Level 1 Server (Scored):
        # We will make sure xinetd is not installed.
        audit:
          - "rpm -q xinetd"
        expected:
          - 1
      2.1.5 Ensure time services are not enabled - Level 1 Server (Scored):
        # We will make sure xinetd is not installed.
        audit:
          - "rpm -q xinetd"
        expected:
          - 1
      2.1.6 Ensure tftp server is not enabled - Level 1 Server (Scored):
        # We will make sure xinetd is not installed.
        audit:
          - "rpm -q xinetd"
        expected:
          - 1
      2.1.7 Ensure xinetd is not enabled - Level 1 Server (Scored):
        # We will make sure xinetd is not installed.
        audit:
          - "rpm -q xinetd"
          - "systemctl is-enabled xinetd | grep enabled"
        expected:
          - 1
          - 1
    2.2 Special Purpose Services:
      2.2.1 Time Synchronization:
        2.2.1.1 Ensure time synchronization is in use - Level 1 Server (Not Scored):
          audit:
            - "rpm -q ntp || rpm -q chrony"
          expected:
            - 0
        2.2.1.2 Ensure ntp is configured - Level 1 Server (Scored):
          audit:
            - "grep ^restrict /etc/ntp.conf | grep 'restrict -4 default kod nomodify notrap nopeer noquery'"
            - "grep ^restrict /etc/ntp.conf | grep 'restrict -6 default kod nomodify notrap nopeer noquery'"
            - "grep ^server /etc/ntp.conf | grep 'server 0.pool.ntp.org'"
            - "grep ^server /etc/ntp.conf | grep 'server 1.pool.ntp.org'"
            - "grep ^server /etc/ntp.conf | grep 'server 2.pool.ntp.org'"
            - "grep ^server /etc/ntp.conf | grep 'server 3.pool.ntp.org'"
          expected:
            - 0
            - 0
            - 0
            - 0
            - 0
            - 0
        2.2.1.3 Ensure chrony is configured - Level 1 Server (Scored):
          audit:
            - "grep ^server /etc/chrony.conf | grep 'server\\s*.*'"
            - "grep ^OPTIONS /etc/sysconfig/chronyd | grep 'OPTIONS=\"-u chrony\"'"
          expected:
            - 0
            - 0
      2.2.2 Ensure X Window System is not installed - Level 1 Server (Scored):
        audit:
          - "rpm -qa xorg-x11* | wc -l | grep ^0"
        expected:
          - 0
      2.2.3 Ensure Avahi Server is not enabled - Level 1 Server (Scored):
        # We will make sure avahi is not installed.
        audit:
          - "rpm -q avahi"
          - "systemctl is-enabled avahi-daemon | grep enabled"
        expected:
          - 1
          - 1
      2.2.4 Ensure CUPS is not enabled - Level 1 Server (Scored):
        # We will make sure CUPS is not installed.
        audit:
          - "rpm -q cups"
          - "systemctl is-enabled cups | grep enabled"
        expected:
          - 1
          - 1
      2.2.5 Ensure DHCP Server is not enabled - Level 1 Server (Scored):
        # We will make sure CUPS is not installed.
        audit:
          - "rpm -q dhcp"
          - "systemctl is-enabled dhcpd | grep enabled"
        expected:
          - 1
          - 1
      2.2.6 Ensure LDAP server is not enabled - Level 1 Server (Scored):
        audit:
          - "systemctl is-enabled slapd | grep enabled"
        expected:
          - 1
      2.2.7 Ensure NFS and RPC are not enabled - Level 1 Server (Scored):
        audit:
          - "systemctl is-enabled nfs | grep enabled"
          - "systemctl is-enabled rpcbind | grep enabled"
        expected:
          - 1
          - 1
      2.2.8 Ensure DNS Server is not enabled - Level 1 Server (Scored):
        # We will make sure bind and bind-utils are not installed.
        audit:
          - "rpm -q bind"
          - "rpm -q bind-utils"
          - "systemctl is-enabled named | grep enabled"
        expected:
          - 1
          - 1
          - 1
      2.2.9 Ensure FTP Server is not enabled - Level 1 Server (Scored):
        # We will make sure vsftpd is not installed.
        audit:
          - "rpm -q vsftpd"
          - "systemctl is-enabled vsftpd | grep enabled"
        expected:
          - 1
          - 1
      2.2.10 Ensure HTTP server is not enabled - Level 1 Server (Scored):
        # We will make sure httpd is not installed.
        audit:
          - "rpm -q httpd"
          - "systemctl is-enabled httpd | grep enabled"
        expected:
          - 1
          - 1
      2.2.11 Ensure IMAP and POP3 server is not enabled - Level 1 Server (Scored):
        # We will make sure dovecot is not installed.
        audit:
          - "rpm -q dovecot"
          - "systemctl is-enabled dovecot | grep enabled"
        expected:
          - 1
          - 1
      2.2.12 Ensure Samba is not enabled - Level 1 Server (Scored):
        # We will make sure samba is not installed.
        audit:
          - "rpm -q samba"
          - "systemctl is-enabled smb | grep enabled"
        expected:
          - 1
          - 1
      2.2.13 Ensure HTTP Proxy Server is not enabled - Level 1 Server (Scored):
        # We will make sure squid is not installed.
        audit:
          - "rpm -q squid"
          - "systemctl is-enabled squid | grep enabled"
        expected:
          - 1
          - 1
      2.2.14 Ensure SNMP Server is not enabled - Level 1 Server (Scored):
        # We will make sure net-snmp is not installed.
        audit:
          - "rpm -q net-snmp"
          - "systemctl is-enabled snmpd | grep enabled"
        expected:
          - 1
          - 1
      2.2.15 Ensure mail transfer agent is configured for local-only mode - Level 1 Server (Scored):
        # We will assume the mta on Centos 7.2 is sendmail.
        audit:
          - "netstat -an | grep LIST | grep ':25\\s' | grep mail"
        expected:
          - 1
      2.2.16 Ensure NIS Server is not enabled - Level 1 Server (Scored):
        audit:
          - "rpm -q ypserv"
          - "systemctl is-enabled ypserv | grep enabled"
        expected:
          - 1
          - 1
      2.2.17 Ensure rsh server is not enabled - Level 1 Server (Scored):
        audit:
          - "systemctl is-enabled rsh.socket | grep enabled"
          - "systemctl is-enabled rlogin.socket | grep enabled"
          - "systemctl is-enabled rexec.socket | grep enabled"
        expected:
          - 1
          - 1
          - 1
      2.2.18 Ensure telnet server is not enabled - Level 1 Server (Scored):
        audit:
          - "systemctl is-enabled telnet.socket | grep enabled"
        expected:
          - 1
      2.2.19 Ensure tftp server is not enabled - Level 1 Server (Scored):
        # We will make sure tftp and tftp-server are not installed.
        audit:
          - "rpm -q tftp"
          - "rpm -q tftp-server"
          - "systemctl is-enabled tftp.socket | grep enabled"
        expected:
          - 1
          - 1
          - 1
      2.2.20 Ensure rsync service is not enabled - Level 1 Server (Scored):
        audit:
          - "systemctl is-enabled rsyncd | grep enabled"
        expected:
          - 1
      2.2.21 Ensure talk server is not enabled - Level 1 Server (Scored):
        audit:
          - "systemctl is-enabled ntalk | grep enabled"
        expected:
          - 1
    2.3 Service Clients:
      2.3.1 Ensure NIS Client is not installed - Level 1 Server (Scored):
        audit:
          - "rpm -q ypbind"
        expected:
          - 1
      2.3.2 Ensure rsh client is not installed - Level 1 Server (Scored):
        audit:
          - "rpm -q rsh"
          - "rpm -q rsh-server"
        expected:
          - 1
          - 1
      2.3.3 Ensure talk client is not installed - Level 1 Server (Scored):
        audit:
          - "rpm -q talk-server"
        expected:
          - 1
      2.3.4 Ensure telnet client is not installed - Level 1 Server (Scored):
        audit:
          - "rpm -q telnet"
          - "rpm -q telnet-server"
        expected:
          - 1
          - 1
      2.3.5 Ensure LDAP client is not installed - Level 1 Server (Scored):
        audit:
          - "rpm -q openldap"
          - "rpm -q openldap-clients"
          - "rpm -q openldap-servers"
        expected:
          - 1
          - 1
          - 1
  3 Network Configuration:
    3.1 Network Parameters (Host Only):
      3.1.1 Ensure IP forwarding is disabled - Level 1 Server (Scored):
        audit:
          - "sysctl net.ipv4.ip_forward | grep 'net.ipv4.ip_forward = 0'"
        expected:
          - 0
      3.1.2 Ensure packet redirect sending is disabled - Level 1 Server (Scored):
        audit:
          - "sysctl net.ipv4.conf.all.send_redirects | grep 'net.ipv4.conf.all.send_redirects = 0'"
          - "sysctl net.ipv4.conf.default.send_redirects | grep 'net.ipv4.conf.default.send_redirects = 0'"
        expected:
          - 0
          - 0
    3.2 Network Parameters (Host and Router):
      3.2.1 Ensure source routed packets are not accepted - Level 1 Server (Scored):
        audit:
          - "sysctl net.ipv4.conf.all.accept_source_route | grep 'net.ipv4.conf.all.accept_source_route = 0'"
          - "sysctl net.ipv4.conf.default.accept_source_route | grep 'net.ipv4.conf.default.accept_source_route = 0'"
        expected:
          - 0
          - 0
      3.2.2 Ensure ICMP redirects are not accepted - Level 1 Server (Scored):
        audit:
          - "sysctl net.ipv4.conf.all.accept_redirects | grep 'net.ipv4.conf.all.accept_redirects = 0'"
          - "sysctl net.ipv4.conf.default.accept_redirects | grep 'net.ipv4.conf.default.accept_redirects = 0'"
        expected:
          - 0
          - 0
      3.2.3 Ensure secure ICMP redirects are not accepted - Level 1 Server (Scored):
        audit:
          - "sysctl net.ipv4.conf.all.secure_redirects | grep 'net.ipv4.conf.all.secure_redirects = 0'"
          - "sysctl net.ipv4.conf.default.secure_redirects | grep 'net.ipv4.conf.default.secure_redirects = 0'"
        expected:
          - 0
          - 0
      3.2.4 Ensure suspicious packets are logged - Level 1 Server (Scored):
        audit:
          - "sysctl net.ipv4.conf.all.log_martians | grep 'net.ipv4.conf.all.log_martians = 1'"
          - "sysctl net.ipv4.conf.default.log_martians | grep 'net.ipv4.conf.default.log_martians = 1'"
        expected:
          - 0
          - 0
      3.2.5 Ensure broadcast ICMP requests are ignored - Level 1 Server (Scored):
        audit:
          - "sysctl net.ipv4.icmp_echo_ignore_broadcasts | grep 'net.ipv4.icmp_echo_ignore_broadcasts = 1'"
        expected:
          - 0
      3.2.6 Ensure bogus ICMP responses are ignored - Level 1 Server (Scored):
        audit:
          - "sysctl net.ipv4.icmp_ignore_bogus_error_responses | grep 'net.ipv4.icmp_ignore_bogus_error_responses = 1'"
        expected:
          - 0
      3.2.7 Ensure Reverse Path Filtering is enabled - Level 1 Server (Scored):
        audit:
          - "sysctl net.ipv4.conf.all.rp_filter | grep 'net.ipv4.conf.all.rp_filter = 1'"
          - "sysctl net.ipv4.conf.default.rp_filter | grep 'net.ipv4.conf.default.rp_filter = 1'"
        expected:
          - 0
          - 0
      3.2.8 Ensure TCP SYN Cookies is enabled - Level 1 Server (Scored):
        audit:
          - "sysctl net.ipv4.tcp_syncookies | grep 'net.ipv4.tcp_syncookies = 1'"
        expected:
          - 0
    3.3 IPv6:
      3.3.1 Ensure IPv6 router advertisements are not accepted - Level 1 Server (Scored):
        audit:
          - "sysctl net.ipv6.conf.all.accept_ra | grep 'net.ipv6.conf.all.accept_ra = 0'"
          - "sysctl net.ipv6.conf.default.accept_ra | grep 'net.ipv6.conf.default.accept_ra = 0'"
        expected:
          - 0
          - 0
      3.3.2 Ensure IPv6 redirects are not accepted - Level 1 Server (Scored):
        audit:
          - "sysctl net.ipv6.conf.all.accept_redirects | grep 'net.ipv6.conf.all.accept_redirects = 0'"
          - "sysctl net.ipv6.conf.default.accept_redirects | grep 'net.ipv6.conf.default.accept_redirects = 0'"
        expected:
          - 0
          - 0
      3.3.3 Ensure IPv6 is disabled - Level 1 Server (Not Scored):
        audit:
          - skip
        expected:
          - 0
    3.4 TCP Wrappers:
      3.4.1 Ensure TCP Wrappers is installed - Level 1 Server (Scored):
        audit:
          - "rpm -q tcp_wrappers"
          - "rpm -q tcp_wrappers-libs"
        expected:
          - 0
          - 0
      3.4.2 Ensure /etc/hosts.allow is configured - Level 1 Server (Scored):
        audit:
          - "cat /etc/hosts.allow"
        expected:
          - 0
      3.4.3 Ensure /etc/hosts.deny is configured - Level 1 Server (Scored):
        audit:
          - "cat /etc/hosts.allow"
        expected:
          - 0
      3.4.4 Ensure permissions on /etc/hosts.allow are 644 - Level 1 Server (Scored):
        audit:
          - "stat /etc/hosts.allow | grep 'Access:\\s(0644/-rw-r--r--)'"
          - "stat /etc/hosts.allow | grep 'Uid:\\s(\\s*0/[\\s*root)'"
          - "stat /etc/hosts.allow | grep 'Gid:\\s(\\s*0/\\s*root)'"
        expected:
          - 0
          - 0
          - 0
      3.4.5 Ensure permissions on /etc/hosts.deny are 644 - Level 1 Server (Scored):
        audit:
          - "stat /etc/hosts.deny | grep 'Access:\\s(0644/-rw-r--r--)'"
          - "stat /etc/hosts.deny | grep 'Uid:\\s(\\s*0/\\s*root)'"
          - "stat /etc/hosts.deny | grep 'Gid:\\s(\\s*0/\\s*root)'"
        expected:
          - 0
          - 0
          - 0
    3.5 Uncommon Network Protocols:
      3.5.1 Ensure DCCP is disabled - Level 1 Server (Not Scored):
        audit:
          - "modprobe -n -v dccp | grep /bin/true"
          - "lsmod | grep dccp"
        expected:
          - 0
          - 1
      3.5.2 Ensure SCTP is disabled - Level 1 Server (Not Scored):
        audit:
          - "modprobe -n -v sctp | grep /bin/true"
          - "lsmod | grep sctp"
        expected:
          - 0
          - 1
      3.5.3 Ensure RDS is disabled - Level 1 Server (Not Scored):
        audit:
          - "modprobe -n -v rds | grep /bin/true"
          - "lsmod | grep rds"
        expected:
          - 0
          - 1
      3.5.4 Ensure TIPC is disabled - Level 1 Server (Not Scored):
        audit:
          - "modprobe -n -v tipc | grep /bin/true"
          - "lsmod | grep tipc"
        expected:
          - 0
          - 1
    3.6 Firewall Configuration:
      3.6.1 Ensure iptables is installed - Level 1 Server (Scored):
        audit:
          - "rpm -q iptables"
        expected:
          - 0
      3.6.2 Ensure default deny firewall policy - Level 1 Server (Scored):
        audit:
          - "iptables -L | egrep 'Chain INPUT \\(policy DROP\\)|Chain INPUT \\(policy REJECT\\)'"
        expected:
          - 0
      3.6.3 Ensure loopback traffic is configured - Level 1 Server (Scored):
        audit:
          - "iptables -L INPUT -v -n | egrep 'ACCEPT.+lo.+0\\.0\\.0\\.0/0'"
          - "iptables -L INPUT -v -n | egrep 'DROP.+127\\.0\\.0\\.0/8'"
        expected:
          - 0
          - 0
      3.6.4 Ensure outbound and established connections are configured - Level 1 Server (Not Scored):
        audit:
          - skip
        expected:
          - 0
      3.6.5 Ensure firewall rules exist for all open ports - Level 1 Server (Scored):
        audit:
          # Intentional Failure - Firewall rules will be captured as security group rules.
          - skip
        expected:
          - 1
    3.7 Ensure wireless interfaces are disabled - Level 1 Server (Not Scored):
      audit:
        - skip
      expected:
        - 0
  4 Logging and Auditing:
    4.1 Configure System Accounting (auditd):
      4.1.1 Configure Data Retention:
        4.1.1.1 Ensure audit log storage size is configured - Level 2 Server (Not Scored):
          audit:
            - skip
          expected:
            - 0
        4.1.1.2 Ensure system is disabled when audit logs are full - Level 2 Server (Scored):
          audit:
            - "grep '^space_left_action =' /etc/audit/auditd.conf | grep -i email"
            - "grep '^action_mail_acct =' /etc/audit/auditd.conf | grep -i root"
            - "grep '^admin_space_left_action =' /etc/audit/auditd.conf | grep -i halt"
          expected:
            - 0
            - 0
            - 0
        4.1.1.3 Ensure audit logs are not automatically deleted - Level 2 Server (Scored):
          audit:
            - "grep '^max_log_file_action =' /etc/audit/auditd.conf | grep -i keep_logs"
          expected:
            - 0
        4.1.2 Ensure auditd service is enabled - Level 2 Server (Scored):
          audit:
            - "systemctl is-enabled auditd | grep enabled"
          expected:
            - 0
        4.1.3 Ensure auditing for processes that start prior to auditd is enabled - Level 2 Server (Scored):
          audit:
            - "grep '^\\s*linux' /boot/grub2/grub.cfg | grep audit=1"
          expected:
            - 0
        4.1.4 Ensure events that modify date and time information are collected - Level 2 Server (Scored):
          audit:
            - "grep time-change /etc/audit/audit.rules | grep '-a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time-change'"
            - "grep time-change /etc/audit/audit.rules | grep '-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k time-change'"
            - "grep time-change /etc/audit/audit.rules | grep '-a always,exit -F arch=b64 -S clock_settime -k time-change'"
            - "grep time-change /etc/audit/audit.rules | grep '-a always,exit -F arch=b32 -S clock_settime -k time-change'"
            - "grep time-change /etc/audit/audit.rules | grep '-w /etc/localtime -p wa -k time-change'"
          expected:
            - 0
            - 0
            - 0
            - 0
            - 0
        4.1.5 Ensure events that modify user/group information are collected - Level 2 Server (Scored):
          audit:
            - "grep identity /etc/audit/audit.rules | grep '-w /etc/group -p wa -k identity'"
            - "grep identity /etc/audit/audit.rules | grep '-w /etc/passwd -p wa -k identity'"
            - "grep identity /etc/audit/audit.rules | grep '-w /etc/gshadow -p wa -k identity'"
            - "grep identity /etc/audit/audit.rules | grep '-w /etc/shadow -p wa -k identity'"
            - "grep identity /etc/audit/audit.rules | grep '-w /etc/security/opasswd -p wa -k identity'"
          expected:
            - 0
            - 0
            - 0
            - 0
            - 0
        4.1.6 Ensure events that modify the system's network environment are collected - Level 2 Server (Scored):
          audit:
            - "grep system-locale /etc/audit/audit.rules | grep '-a always,exit -F arch=b64 -S sethostname -S setdomainname -k system-locale'"
            - "grep system-locale /etc/audit/audit.rules | grep '-a always,exit -F arch=b32 -S sethostname -S setdomainname -k system-locale'"
            - "grep system-locale /etc/audit/audit.rules | grep '-w /etc/issue -p wa -k system-locale'"
            - "grep system-locale /etc/audit/audit.rules | grep '-w /etc/issue.net -p wa -k system-locale'"
            - "grep system-locale /etc/audit/audit.rules | grep '-w /etc/hosts -p wa -k system-locale'"
            - "grep system-locale /etc/audit/audit.rules | grep '-w /etc/sysconfig/network -p wa -k system-locale'"
          expected:
            - 0
            - 0
            - 0
            - 0
            - 0
            - 0
        4.1.7 Ensure events that modify the system's Mandatory Access Controls are collected - Level 2 Server (Scored):
          audit:
            - "grep MAC-policy /etc/audit/audit.rules | grep '-w /etc/selinux/ -p wa -k MAC-policy'"
          expected:
            - 0
        4.1.8 Ensure login and logout events are collected - Level 2 Server (Scored):
          audit:
            - "grep logins /etc/audit/audit.rules | grep '-w /var/log/lastlog -p wa -k logins'"
            - "grep logins /etc/audit/audit.rules | grep '-w /var/run/faillock/ -p wa -k logins'"
          expected:
            - 0
            - 0
        4.1.9 Ensure session initiation information is collected - Level 2 Server (Scored):
          audit:
            - "grep session /etc/audit/audit.rules | grep '-w /var/run/utmp -p wa -k session'"
            - "grep session /etc/audit/audit.rules | grep '-w /var/log/wtmp -p wa -k session'"
            - "grep session /etc/audit/audit.rules | grep '-w /var/log/btmp -p wa -k session'"
          expected:
            - 0
            - 0
            - 0
        4.1.10 Ensure discretionary access control permission modification events are collected - Level 2 Server (Scored):
          audit:
            - "grep perm_mod /etc/audit/audit.rules | grep '-a always,exit -F arch=b64 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod'"
            - "grep perm_mod /etc/audit/audit.rules | grep '-a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_mod'"
            - "grep perm_mod /etc/audit/audit.rules | grep '-a always,exit -F arch=b64 -S chown -S fchown -S fchownat -S lchown -F auid>=1000 -F auid!=4294967295 -k perm_mod'"
            - "grep perm_mod /etc/audit/audit.rules | grep '-a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F auid>=1000 -F auid!=4294967295 -k perm_mod'"
          expected:
            - 0
            - 0
            - 0
            - 0
        4.1.11 Ensure unsuccessful unauthorized file access attempts are collected - Level 2 Server (Scored):
          audit:
            - "grep access /etc/audit/audit.rules | grep '-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access'"
            - "grep access /etc/audit/audit.rules | grep '-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access'"
            - "grep access /etc/audit/audit.rules | grep '-a always,exit -F arch=b64 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access'"
            - "grep access /etc/audit/audit.rules | grep '-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access'"
          expected:
            - 0
            - 0
            - 0
            - 0
        4.1.12 Ensure use of privileged commands is collected - Level 2 Server (Scored):
          audit:
            - "find / -xdev \\( -perm -4000 -o -perm -2000 \\) -type f | awk '{print \"-a always,exit -F path=\" $1 \" -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\" }' | wc -l | grep ^0"
          expected:
            - 1
        4.1.13 Ensure successful file system mounts are collected - Level 2 Server (Scored):
          audit:
            - "grep mounts /etc/audit/audit.rules | grep '-a always,exit -F arch=b64 -S mount -F auid>=1000 -F auid!=4294967295 -k mounts'"
            - "grep mounts /etc/audit/audit.rules | grep '-a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=4294967295 -k mounts'"
          expected:
            - 0
            - 0
        4.1.14 Ensure file deletion events by users are collected - Level 2 Server (Scored):
          audit:
            - "grep delete /etc/audit/audit.rules | grep '-a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F auid>=1000 -F auid!=4294967295 -k delete'"
            - "grep delete /etc/audit/audit.rules | grep '-a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F auid>=1000 -F auid!=4294967295 -k delete'"
          expected:
            - 0
            - 0
        4.1.15 Ensure changes to system administration scope (sudoers) is collected - Level 2 Server (Scored):
          audit:
            - "grep scope /etc/audit/audit.rules | grep '-w /etc/sudoers -p wa -k scope'"
            - "grep scope /etc/audit/audit.rules | grep '-w /etc/sudoers.d -p wa -k scope'"
          expected:
            - 0
            - 0
        4.1.16 Ensure system administrator actions (sudolog) are collected - Level 2 Server (Scored):
          audit:
            - "grep actions /etc/audit/audit.rules | grep '-w /var/log/sudo.log -p wa -k actions'"
          expected:
            - 0
        4.1.17 Ensure kernel module loading and unloading is collected - Level 2 Server (Scored):
          audit:
            - "grep actions /etc/audit/audit.rules | grep '-w /sbin/insmod -p x -k modules'"
            - "grep actions /etc/audit/audit.rules | grep '-w /sbin/rmmod -p x -k modules'"
            - "grep actions /etc/audit/audit.rules | grep '-w /sbin/modprobe -p x -k modules'"
            - "grep actions /etc/audit/audit.rules | grep '-a always,exit arch=b64 -S init_module -S delete_module -k modules'"
          expected:
            - 0
            - 0
            - 0
            - 0
        4.1.18 Ensure the audit configuration is immutable - Level 2 Server (Scored):
          audit:
            - "grep '^\\s*[^#]' /etc/audit/audit.rules | tail -1 | grep '-e 2'"
          expected:
            - 0
      4.2.1 Configure rsyslog:
        4.2.1.1 Ensure rsyslog Service is enabled - Level 1 Server (Scored):
          audit:
            - "systemctl is-enabled rsyslog | grep enabled"
          expected:
            - 0
        4.2.1.2 Ensure logging is configured - Level 1 Server (Not Scored):
          audit:
            - skip
          expected:
            - 0
        4.2.1.3 Ensure rsyslog default file permissions configured - Level 1 Server (Scored):
          audit:
            - "grep ^\\$FileCreateMode /etc/rsyslog.conf | grep 0640"
          expected:
            - 0
        4.2.1.4 Ensure rsyslog is configured to send logs to a remote log host - Level 1 Server (Scored):
          audit:
            - "grep '^*.*[^I][^I]*@' /etc/rsyslog.conf | wc -l | grep ^0"
          expected:
            - 1
        4.2.1.5 Ensure remote rsyslog messages are only accepted on designated log hosts - Level 1 Server (Not Scored):
          audit:
            - "grep ^\\$ModLoad imtcp.so /etc/rsyslog.conf"
            - "grep ^\\$InputTCPServerRun /etc/rsyslog.conf | grep 514"
          expected:
            - 0
            - 0
      4.2.2 Configure syslog-ng:
        4.2.2.1 Ensure syslog-ng service is enabled - Level 1 Server (Scored):
          audit:
            - "systemctl is-enabled syslog-ng | grep enabled"
          expected:
            - 0
        4.2.2.2 Ensure logging is configured - Level 1 Server (Not Scored):
          audit:
            - skip
          expected:
            - 0
        4.2.2.3 Ensure syslog-ng default file permissions configured - Level 1 Server (Scored):
          audit:
            - "grep 'chain_hostnames (off)' /etc/syslog-ng/syslog-ng.conf"
            - "grep 'flush_lines (0)' /etc/syslog-ng/syslog-ng.conf"
            - "grep 'perm (0640)' /etc/syslog-ng/syslog-ng.conf"
            - "grep 'stats_freq (3600)' /etc/syslog-ng/syslog-ng.conf"
            - "grep 'threaded (yes)' /etc/syslog-ng/syslog-ng.conf"
          expected:
            - 0
            - 0
            - 0
            - 0
            - 0
        4.2.2.4 Ensure syslog-ng is configured to send logs to a remote log host - Level 1 Server (Not Scored):
          audit:
            - skip
          expected:
            - 0
        4.2.2.5 Ensure remote syslog-ng messages are only accepted on designated log hosts - Level 1 Server (Not Scored):
          audit:
            - skip
          expected:
            - 0
      4.2.3 Ensure rsyslog or syslog-ng is installed - Level 1 Server (Scored):
        audit:
          - "rpm -q rsyslog"
          - "rpm -q syslog-ng"
        expected:
          - 0
          - 0
      4.2.4 Ensure permissions on all logfiles are configured - Level 1 Server (Scored):
        audit:
          - "find /var/log -type f -ls | grep -e '-........x' | wc -l | grep ^0"
          - "find /var/log -type f -ls | grep -e '-.......w.' | wc -l | grep ^0"
          - "find /var/log -type f -ls | grep -e '-......r..' | wc -l | grep ^0"
          - "find /var/log -type f -ls | grep -e '-.....x...' | wc -l | grep ^0"
          - "find /var/log -type f -ls | grep -e '-....w....' | wc -l | grep ^0"
        expected:
          - 0
          - 0
          - 0
          - 0
          - 0
    4.3 Ensure logrotate is configured - Level 1 Server (Not Scored):
      audit:
        - skip
      expected:
        - 0
  5 Access, Authentication and Authorization:
    5.1 Configure cron:
      5.1.1 Ensure cron daemon is enabled - Level 1 Server (Scored):
        audit:
          - "systemctl is-enabled crond | grep enabled"
        expected:
          - 0
      5.1.2 Ensure permissions on /etc/crontab are configured - Level 1 Server (Scored):
        audit:
          - "stat /etc/crontab | grep 'Access:\\s(0600/-rw-------)'"
          - "stat /etc/crontab | grep 'Uid:\\s(\\s*0/\\s*root)'"
          - "stat /etc/crontab | grep 'Gid:\\s(\\s*0/\\s*root)'"
        expected:
          - 0
          - 0
          - 0
      5.1.3 Ensure permissions on /etc/cron.hourly are configured - Level 1 Server (Scored):
        audit:
          - "stat /etc/cron.hourly | grep 'Access:\\s(0600/-rw-------)'"
          - "stat /etc/cron.hourly | grep 'Uid:\\s(\\s*0/\\s*root)'"
          - "stat /etc/cron.hourly | grep 'Gid:\\s(\\s*0/\\s*root)'"
        expected:
          - 0
          - 0
          - 0
      5.1.4 Ensure permissions on /etc/cron.daily are configured - Level 1 Server (Scored):
        audit:
          - "stat /etc/cron.daily | grep 'Access:\\s(0600/-rw-------)'"
          - "stat /etc/cron.daily | grep 'Uid:\\s(\\s*0/\\s*root)'"
          - "stat /etc/cron.daily | grep 'Gid:\\s([\\s*0/\\s*root)'"
        expected:
          - 0
          - 0
          - 0
      5.1.5 Ensure permissions on /etc/cron.weekly are configured - Level 1 Server (Scored):
        audit:
          - "stat /etc/cron.weekly | grep 'Access:\\s(0600/-rw-------)'"
          - "stat /etc/cron.weekly | grep 'Uid:\\s(\\s*0/\\s*root)'"
          - "stat /etc/cron.weekly | grep 'Gid:\\s(\\s*0/\\s*root)'"
        expected:
          - 0
          - 0
          - 0
      5.1.6 Ensure permissions on /etc/cron.monthly are configured - Level 1 Server (Scored):
        audit:
          - "stat /etc/cron.monthly | grep 'Access:\\s(0600/-rw-------)'"
          - "stat /etc/cron.monthly | grep 'Uid:\\s(\\s*0/\\s*root)'"
          - "stat /etc/cron.monthly | grep 'Gid:\\s(\\s*0/\\s*root)'"
        expected:
          - 0
          - 0
          - 0
      5.1.7 Ensure permissions on /etc/cron.d are configured - Level 1 Server (Scored):
        audit:
          - "stat /etc/cron.d | grep 'Access:\\s(0600/-rw-------)'"
          - "stat /etc/cron.d | grep 'Uid:\\s(\\s*0/\\s*root)'"
          - "stat /etc/cron.d | grep 'Gid:\\s(\\s*0/\\s*root)'"
        expected:
          - 0
          - 0
          - 0
      5.1.8 Ensure at/cron is restricted to authorized users - Level 1 Server (Scored):
        audit:
          - "stat /etc/cron.deny"
          - "stat /etc/at.deny"
          - "stat /etc/cron.allow | grep 'Access:\\s(0600/-rw-------)'"
          - "stat /etc/cron.allow | grep 'Uid:\\s(\\s*0/\\s*root)'"
          - "stat /etc/cron.allow | grep 'Gid:\\s(\\s*0/\\s*root)'"
        expected:
          - 1
          - 1
          - 0
          - 0
          - 0
    5.2 SSH Server Configuration:
      5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured - Level 1 Server (Scored):
        audit:
          - "stat /etc/ssh/sshd_config | grep 'Access:\\s(0600/-rw-------)'"
          - "stat /etc/ssh/sshd_config | grep 'Uid:\\s(\\s*0/\\s*root)'"
          - "stat /etc/ssh/sshd_config | grep 'Gid:\\s(\\s*0/\\s*root)'"
        expected:
          - 0
          - 0
          - 0
      5.2.2 Ensure SSH Protocol is set to 2 - Level 1 Server (Scored):
        audit:
          - "grep ^Protocol /etc/ssh/sshd_config | grep 'Protocol 2'"
        expected:
          - 0
      5.2.3 Ensure SSH LogLevel is set to INFO - Level 1 Server (Scored):
        audit:
          - "grep ^LogLevel /etc/ssh/sshd_config | grep 'LogLevel INFO'"
        expected:
          - 0
      5.2.4 Ensure SSH X11 forwarding is disabled - Level 1 Server (Scored):
        audit:
          - "grep ^X11Forwarding /etc/ssh/sshd_config | grep 'X11Forwarding no'"
        expected:
          - 0
      5.2.5 Ensure SSH MaxAuthTries is set to 4 or less - Level 1 Server (Scored):
        audit:
          - "COUNT=$(grep ^MaxAuthTries /etc/ssh/sshd_config | sed 's/MaxAuthTries\\s*\\(.*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -le 4 ]]"
        expected:
          - 0
      5.2.6 Ensure SSH IgnoreRhosts is enabled - Level 1 Server (Scored):
        audit:
          - "grep ^IgnoreRhosts /etc/ssh/sshd_config | grep 'IgnoreRhosts yes'"
        expected:
          - 0
      5.2.7 Ensure SSH HostbasedAuthentication is disabled - Level 1 Server (Scored):
        audit:
          - "grep ^HostbasedAuthentication /etc/ssh/sshd_config | grep 'HostbasedAuthentication no'"
        expected:
          - 0
      5.2.8 Ensure SSH root login is disabled - Level 1 Server (Scored):
        audit:
          - "grep ^PermitRootLogin /etc/ssh/sshd_config | grep 'PermitRootLogin no'"
        expected:
          - 0
      5.2.9 Ensure SSH PermitEmptyPasswords is disabled - Level 1 Server (Scored):
        audit:
          - "grep ^PermitEmptyPasswords /etc/ssh/sshd_config | grep 'PermitEmptyPasswords no'"
        expected:
          - 0
      5.2.10 Ensure SSH PermitUserEnvironment is disabled - Level 1 Server (Scored):
        audit:
          - "grep ^PermitUserEnvironment /etc/ssh/sshd_config | grep 'PermitUserEnvironment no'"
        expected:
          - 0
      5.2.11 Ensure only approved ciphers are used - Level 1 Server (Scored):
        audit:
          - "grep ^Ciphers /etc/ssh/sshd_config | grep aes256-ctr"
          - "grep ^Ciphers /etc/ssh/sshd_config | grep aes192-ctr"
          - "grep ^Ciphers /etc/ssh/sshd_config | grep aes128-ctr"
          - "grep ^Ciphers /etc/ssh/sshd_config | grep cbc"
        expected:
          - 0
          - 0
          - 0
          - 1
      5.2.12 Ensure only approved MAC algorithms are used - Level 1 Server (Scored):
        audit:
          - "grep ^MACs /etc/ssh/sshd_config | grep hmac-sha2-512-etm@openssh.com"
          - "grep ^MACs /etc/ssh/sshd_config | grep hmac-sha2-256-etm@openssh.com"
          - "grep ^MACs /etc/ssh/sshd_config | grep umac-128-etm@openssh.com"
          - "grep ^MACs /etc/ssh/sshd_config | grep hmac-sha2-512"
          - "grep ^MACs /etc/ssh/sshd_config | grep hmac-sha2-256"
          - "grep ^MACs /etc/ssh/sshd_config | grep umac-128@openssh.com"
          - "grep ^MACs /etc/ssh/sshd_config | grep md5"
          - "grep ^MACs /etc/ssh/sshd_config | grep sha1"
        expected:
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 1
          - 1
      5.2.13 Ensure SSH Idle Timeout Interval is configured - Level 1 Server (Scored):
        audit:
          - "COUNT=$(grep ^ClientAliveInterval /etc/ssh/sshd_config | sed 's/ClientAliveInterval\\s*\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -le 300 ]]"
          - "COUNT=$(grep ^ClientAliveCountMax /etc/ssh/sshd_config | sed 's/ClientAliveCountMax\\s*\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -le 3 ]]"
        expected:
          - 0
          - 0
      5.2.14 Ensure SSH LoginGraceTime is set to one minute or less - Level 1 Server (Scored):
        audit:
          - "COUNT=$(grep ^LoginGraceTime /etc/ssh/sshd_config | sed 's/LoginGraceTime\\s*\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -le 60 ]]"
        expected:
          - 0
      5.2.15 Ensure SSH access is limited - Level 1 Server (Scored):
        audit:
          - "grep 'AllowUsers\\s*[[:alnum:]]\\{1,\\}' /etc/ssh/sshd_config || grep 'AllowGroups\\s*[[:alnum:]]\\{1,\\}' /etc/ssh/sshd_config || grep 'DenyUsers\\s*[[:alnum:]]\\{1,\\}' /etc/ssh/sshd_config || grep 'DenyGroups\\s*[[:alnum:]]\\{1,\\}' /etc/ssh/sshd_config"
        expected:
          - 0
      5.2.16 Ensure SSH warning banner is configured - Level 1 Server (Scored):
        audit:
          - "grep ^Banner /etc/ssh/sshd_config | grep 'Banner /etc/issue.net'"
        expected:
          - 0
    5.3 Configure PAM:
      5.3.1 Ensure password creation requirements are configured - Level 1 Server (Scored):
        audit:
          - "grep pam_pwquality.so /etc/pam.d/password-auth | grep password"
          - "grep pam_pwquality.so /etc/pam.d/password-auth | grep requisite"
          - "grep pam_pwquality.so /etc/pam.d/password-auth | grep pam_pwquality.so"
          - "grep pam_pwquality.so /etc/pam.d/password-auth | grep try_first_pass"
          - "grep pam_pwquality.so /etc/pam.d/password-auth | grep retry=3"
          - "grep pam_pwquality.so /etc/pam.d/system-auth | grep password"
          - "grep pam_pwquality.so /etc/pam.d/system-auth | grep requisite"
          - "grep pam_pwquality.so /etc/pam.d/system-auth | grep pam_pwquality.so"
          - "grep pam_pwquality.so /etc/pam.d/system-auth | grep try_first_pass"
          - "grep pam_pwquality.so /etc/pam.d/system-auth | grep retry=3"
          - "COUNT=$(grep ^minlen /etc/security/pwquality.conf | sed 's/minlen\\s*=\\s*\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -ge 14 ]]"
          - "COUNT=$(grep ^dcredit /etc/security/pwquality.conf | sed 's/dcredit\\s*=\\s*\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -lt 0 ]]"
          - "COUNT=$(grep ^lcredit /etc/security/pwquality.conf | sed 's/lcredit\\s*=\\s*\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -lt 0 ]]"
          - "COUNT=$(grep ^ocredit /etc/security/pwquality.conf | sed 's/ocredit\\s*=\\s*\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -lt 0 ]]"
          - "COUNT=$(grep ^ucredit /etc/security/pwquality.conf | sed 's/ucredit\\s*=\\s*\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -lt 0 ]]"
        expected:
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
      5.3.2 Ensure lockout for failed password attempts is configured - Level 1 Server (Scored):
        audit:
          - "grep '^auth\\s*required\\s*pam_faillock.so' /etc/pam.d/password-auth | grep preauth"
          - "grep '^auth\\s*required\\s*pam_faillock.so' /etc/pam.d/password-auth | grep silent"
          - "grep '^auth\\s*required\\s*pam_faillock.so' /etc/pam.d/password-auth | grep audit"
          - "COUNT=$(grep '^auth\\s*required\\s*pam_faillock.so' /etc/pam.d/password-auth | sed 's/.*deny=\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -ge 3 ]]"
          - "COUNT=$(grep '^auth\\s*required\\s*pam_faillock.so' /etc/pam.d/password-auth | sed 's/.*unlock_time=\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -ge 600 ]]"
          - "grep '^auth\\s*\\[default=die\\]\\s*pam_faillock.so' /etc/pam.d/password-auth | grep authfail"
          - "grep '^auth\\s*\\[default=die\\]\\s*pam_faillock.so' /etc/pam.d/password-auth | grep audit"
          - "COUNT=$(grep '^auth\\s*\\[default=die\\]\\s*pam_faillock.so' /etc/pam.d/password-auth | sed 's/.*deny=\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -ge 3 ]]"
          - "COUNT=$(grep '^auth\\s*\\[default=die\\]\\s*pam_faillock.so' /etc/pam.d/password-auth | sed 's/.*unlock_time=\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -ge 600 ]]"
          - "grep '^auth\\s*required\\s*pam_faillock.so' /etc/pam.d/system-auth | grep preauth"
          - "grep '^auth\\s*required\\s*pam_faillock.so' /etc/pam.d/system-auth | grep silent"
          - "grep '^auth\\s*required\\s*pam_faillock.so' /etc/pam.d/system-auth | grep audit"
          - "COUNT=$(grep '^auth\\s*required\\s*pam_faillock.so' /etc/pam.d/system-auth | sed 's/.*deny=\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -ge 3 ]]"
          - "COUNT=$(grep '^auth\\s*required\\s*pam_faillock.so' /etc/pam.d/system-auth | sed 's/.*unlock_time=\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -ge 600 ]]"
          - "grep '^auth\\s*\\[default=die\\]\\s*pam_faillock.so' /etc/pam.d/system-auth | grep authfail"
          - "grep '^auth\\s*\\[default=die\\]\\s*pam_faillock.so' /etc/pam.d/system-auth | grep audit"
          - "COUNT=$(grep '^auth\\s*\\[default=die\\]\\s*pam_faillock.so' /etc/pam.d/system-auth | sed 's/.*deny=\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -ge 3 ]]"
          - "COUNT=$(grep '^auth\\s*\\[default=die\\]\\s*pam_faillock.so' /etc/pam.d/system-auth | sed 's/.*unlock_time=\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -ge 600 ]]"
        expected:
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
          - 0
      5.3.3 Ensure password reuse is limited - Level 1 Server (Scored):
        audit:
          - "COUNT=$(grep '^password\\s*sufficient\\s*pam_unix.so' /etc/pam.d/password-auth | sed 's/.*remember=\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -ge 5 ]]"
          - "COUNT=$(grep '^password\\s*sufficient\\s*pam_unix.so' /etc/pam.d/system-auth | sed 's/.*remember=\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -ge 5 ]]"
        expected:
          - 0
          - 0
      5.3.4 Ensure password hashing algorithm is SHA-512 - Level 1 Server (Scored):
        audit:
          - "grep '^password\\s*sufficient\\s*pam_unix.so' /etc/pam.d/password-auth | grep sha512"
          - "grep '^password\\s*sufficient\\s*pam_unix.so' /etc/pam.d/system-auth | grep sha512"
        expected:
          - 0
          - 0
    5.4 User Accounts and Environment:
      5.4.1 Set Shadow Password Suite Parameters:
        5.4.1.1 Ensure password expiration is 90 days or less - Level 1 Server (Scored):
          audit:
            - "COUNT=$(grep PASS_MAX_DAYS /etc/login.defs | sed 's/.*PASS_MAX_DAYS\\s*\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -le 90 ]]"
            - "USERS=$(egrep ^[^:]+:[^\\!*] /etc/shadow | cut -d: -f1); for i in $USERS; do COUNT=$(chage --list $i | grep 'Maximum number of days between password change' | sed 's/^Maximum number of days between password change\\s*:\\s*\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -le 90 ]] || exit 1; done"
          expected:
            - 0
            - 0
        5.4.1.2 Ensure minimum days between password changes is 7 or more - Level 1 Server (Scored):
          audit:
            - "COUNT=$(grep PASS_MIN_DAYS /etc/login.defs | sed 's/.*PASS_MIN_DAYS\\s*\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -ge 7 ]]"
            - "USERS=$(egrep ^[^:]+:[^\\!*] /etc/shadow | cut -d: -f1); for i in $USERS; do COUNT=$(chage --list $i | grep 'Minimum number of days between password change' | sed 's/^Minimum number of days between password change\\s*:\\s*\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -ge 7 ]] || exit 1; done"
          expected:
            - 0
            - 0
        5.4.1.3 Ensure password expiration warning days is 7 or more - Level 1 Server (Scored):
          audit:
            - "COUNT=$(grep PASS_WARN_AGE /etc/login.defs | sed 's/.*PASS_WARN_AGE\\s*\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -ge 7 ]]"
            - "USERS=$(egrep ^[^:]+:[^\\!*] /etc/shadow | cut -d: -f1); for i in $USERS; do COUNT=$(chage --list $i | grep 'Number of days of warning before password expires' | sed 's/^Number of days of warning before password expires\\s*:\\s*\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -ge 7 ]] || exit 1; done"
          expected:
            - 0
            - 0
        5.4.1.4 Ensure inactive password lock is 30 days or less - Level 1 Server (Scored):
          audit:
            - "COUNT=$(useradd -D | grep INACTIVE | sed 's/^INACTIVE\\s*:\\s*\\([0-9-]*\\).*/\\1/'); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -le 30 ]]"
          expected:
            - 0
      5.4.2 Ensure system accounts are non-login - Level 1 Server (Scored):
        audit:
          - "egrep -v '^\\+' /etc/passwd | awk -F: '($1!=\"root\" && $1!=\"sync\" && $1!=\"shutdown\" && $1!=\"halt\" && $3<1000 && $7!=\"/sbin/nologin\" && $7!=\"/bin/false\") {print}' | wc -l | grep ^0"
        expected:
          - 0
      5.4.3 Ensure default group for the root account is GID 0 - Level 1 Server (Scored):
        audit:
          - "grep ^root: /etc/passwd | cut -f4 -d: | grep ^0"
        expected:
          - 0
      5.4.4 Ensure default user umask is 027 or more restrictive - Level 1 Server (Scored):
        audit:
          - "UMASK=$(grep ^umask /etc/bashrc | sed 's/.*umask \\([0-9-]*\\).*/\\1/'); [[ ! -z \"$UMASK\" ]] && [[ $UMASK -ge 027 ]]"
          - "UMASK=$(grep ^umask /etc/csh.cshrc | sed 's/.*umask \\([0-9-]*\\).*/\\1/'); [[ ! -z \"$UMASK\" ]] && [[ $UMASK -ge 027 ]]"
          - "UMASK=$(grep ^umask /etc/profile | sed 's/.*umask \\([0-9-]*\\).*/\\1/'); [[ ! -z \"$UMASK\" ]] && [[ $UMASK -ge 027 ]]"
        expected:
          - 0
          - 0
          - 0
    5.5 Ensure root login is restricted to system console - Level 1 Server (Not Scored):
      audit:
        - skip
      expected:
        - 0
    5.6 Ensure access to the su command is restricted - Level 1 Server (Scored):
      audit:
        - "grep pam_wheel.so /etc/pam.d/su | grep '^auth\\s*required\\s*pam_wheel.so\\s*use_uid'"
        - "grep wheel /etc/group | grep 'wheel:x:10:[[:alnum:]]\\{1,\\}'"
      expected:
        - 0
        - 0
  6 System Maintenance:
    6.1 System File Permissions:
      6.1.1 Audit system file permissions - Level 2 Server (Not Scored):
        audit:
          - skip
        expected:
          - 0
      6.1.2 Ensure permissions on /etc/passwd are configured - Level 1 Server (Scored):
        audit:
          - "stat /etc/passwd | grep 'Access:\\s(0644/-rw-r--r--)'"
          - "stat /etc/passwd | grep 'Uid:\\s(\\s*0/\\s*root)'"
          - "stat /etc/passwd | grep 'Gid:\\s(\\s*0/\\s*root)'"
        expected:
          - 0
          - 0
          - 0
      6.1.3 Ensure permissions on /etc/shadow are configured - Level 1 Server (Scored):
        audit:
          - "stat /etc/shadow | grep 'Access:\\s(0000/----------)'"
          - "stat /etc/shadow | grep 'Uid:\\s(\\s*0/\\s*root)'"
          - "stat /etc/shadow | grep 'Gid:\\s(\\s*0/\\s*root)'"
        expected:
          - 0
          - 0
          - 0
      6.1.4 Ensure permissions on /etc/group are configured - Level 1 Server (Scored):
        audit:
          - "stat /etc/group | grep 'Access:\\s(0644/-rw-r--r--)'"
          - "stat /etc/group | grep 'Uid:\\s(\\s*0/\\s*root)'"
          - "stat /etc/group | grep 'Gid:\\s(\\s*0/\\s*root)'"
        expected:
          - 0
          - 0
          - 0
      6.1.5 Ensure permissions on /etc/gshadow are configured - Level 1 Server (Scored):
        audit:
          - "stat /etc/gshadow | grep 'Access:\\s(0600/-rw-------)'"
          - "stat /etc/gshadow | grep 'Uid:\\s(\\s*0/\\s*root)'"
          - "stat /etc/gshadow | grep 'Gid:\\s(\\s*0/\\s*root)'"
        expected:
          - 0
          - 0
          - 0
      6.1.6 Ensure permissions on /etc/passwd- are configured - Level 1 Server (Scored):
        audit:
          - "stat /etc/passwd- | grep 'Access:\\s(0600/-rw-------)'"
          - "stat /etc/passwd- | grep 'Uid:\\s(\\s*0/\\s*root)'"
          - "stat /etc/passwd- | grep 'Gid:\\s(\\s*0/\\s*root)'"
        expected:
          - 0
          - 0
          - 0
      6.1.7 Ensure permissions on /etc/shadow- are configured - Level 1 Server (Scored):
        audit:
          - "stat /etc/shadow- | grep 'Access:\\s(0600/-rw-------)'"
          - "stat /etc/shadow- | grep 'Uid:\\s(\\s*0/\\s*root)'"
          - "stat /etc/shadow- | grep 'Gid:\\s(\\s*0/\\s*root)'"
        expected:
          - 0
          - 0
          - 0
      6.1.8 Ensure permissions on /etc/group- are configured - Level 1 Server (Scored):
        audit:
          - "stat /etc/group- | grep 'Access:\\s(0600/-rw-------)'"
          - "stat /etc/group- | grep 'Uid:\\s(\\s*0/\\s*root)'"
          - "stat /etc/group- | grep 'Gid:\\s(\\s*0/\\s*root)'"
        expected:
          - 0
          - 0
          - 0
      6.1.9 Ensure permissions on /etc/gshadow- are configured - Level 1 Server (Scored):
        audit:
          - "stat /etc/gshadow- | grep 'Access:\\s(0600/-rw-------)'"
          - "stat /etc/gshadow- | grep 'Uid:\\s(\\s*0/\\s*root)'"
          - "stat /etc/gshadow- | grep 'Gid:\\s(\\s*0/\\s*root)'"
        expected:
          - 0
          - 0
          - 0
      6.1.10 Ensure no world writable files exist - Level 1 Server (Scored):
        audit:
          - "df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -type f -perm -0002 | wc -l | grep ^0"
          - "PART=$(df -H | awk '{$1=$2=$3=$4=$5=\"\"}1' | sed s/^\\s*\\(.*\\)/\\1/); for i in $PART; do [[ $i = '/mnt/hgfs' ]] || [[ $i = '/host-data' ]] && continue; COUNT=$(find $i -xdev -type f -perm -0002 2> /dev/null | wc -l); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -eq 0 ]] || exit 1; done"
        expected:
          - 0
          - 0
      6.1.11 Ensure no unowned files or directories exist - Level 1 Server (Scored):
        audit:
          - "df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nouser | wc -l | grep ^0"
          - "PART=$(df -H | awk '{$1=$2=$3=$4=$5=\"\"}1' | sed s/^\\s*\\(.*\\)/\\1/); for i in $PART; do [[ $i = '/mnt/hgfs' ]] || [[ $i = '/host-data' ]] && continue; COUNT=$(find $i -xdev -nouser 2> /dev/null | wc -l); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -eq 0 ]] || exit 1; done"
        expected:
          - 0
          - 0
      6.1.12 Ensure no ungrouped files or directories exist - Level 1 Server (Scored):
        audit:
          - "df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nogroup | wc -l | grep ^0"
          - "PART=$(df -H | awk '{$1=$2=$3=$4=$5=\"\"}1' | sed s/^\\s*\\(.*\\)/\\1/); for i in $PART; do [[ $i = '/mnt/hgfs' ]] || [[ $i = '/host-data' ]] && continue; COUNT=$(find $i -xdev -nogroup 2> /dev/null | wc -l); [[ ! -z \"$COUNT\" ]] && [[ $COUNT -eq 0 ]] || exit 1; done"
        expected:
          - 0
          - 0
      6.1.13 Audit SUID executables - Level 1 Server (Not Scored):
        audit:
          - skip
        expected:
          - 0
      6.1.14 Audit SGID executables - Level 1 Server (Not Scored):
        audit:
          - skip
        expected:
          - 0
    6.2 User and Group Settings:
      6.2.1 Ensure password fields are not empty - Level 1 Server (Scored):
        audit:
          - "cat /etc/shadow | awk -F: '($2 == \"\" ) { print $1 \" does not have a password \"}' | wc -l | grep ^0"
        expected:
          - 0
      6.2.2 Ensure no legacy "+" entries exist in /etc/passwd - Level 1 Server (Scored):
        audit:
          - "grep ^+: /etc/passwd | wc -l | grep ^0"
        expected:
          - 0
      6.2.3 Ensure no legacy "+" entries exist in /etc/shadow - Level 1 Server (Scored):
        audit:
          - "grep ^+: /etc/shadow | wc -l | grep ^0"
        expected:
          - 0
      6.2.4 Ensure no legacy "+" entries exist in /etc/group - Level 1 Server (Scored):
        audit:
          - "grep ^+: /etc/group | wc -l | grep ^0"
        expected:
          - 0
      6.2.5 Ensure root is the only UID 0 account - Level 1 Server (Scored):
        audit:
          - "cat /etc/passwd | awk -F: '($3 == 0) { print $1 }' | grep root"
        expected:
          - 0
      6.2.6 Ensure root PATH Integrity - Level 1 Server (Scored):
        audit:
          - "/etc/system-audit/cis-benchmark-checks/6.2.6.sh | wc -l | grep ^0"
        expected:
          - 0
      6.2.7 Ensure all users' home directories exist - Level 1 Server (Scored):
        audit:
          - "/etc/system-audit/cis-benchmark-checks/6.2.7.sh | wc -l | grep ^0"
        expected:
          - 0
      6.2.8 Ensure users' home directories permissions are 750 or more restrictive - Level 1 Server (Scored):
        audit:
          - "/etc/system-audit/cis-benchmark-checks/6.2.8.sh | wc -l | grep ^0"
        expected:
          - 0
      6.2.9 Ensure users own their home directories - Level 1 Server (Scored):
        audit:
          - "/etc/system-audit/cis-benchmark-checks/6.2.9.sh | wc -l | grep ^0"
        expected:
          - 0
      6.2.10 Ensure users' dot files are not group or world writable - Level 1 Server (Scored):
        audit:
          - "/etc/system-audit/cis-benchmark-checks/6.2.10.sh | wc -l | grep ^0"
        expected:
          - 0
      6.2.11 Ensure no users have .forward files - Level 1 Server (Scored):
        audit:
          - "/etc/system-audit/cis-benchmark-checks/6.2.11.sh | wc -l | grep ^0"
        expected:
          - 0
      6.2.12 Ensure no users have .netrc files - Level 1 Server (Scored):
        audit:
          - "/etc/system-audit/cis-benchmark-checks/6.2.12.sh | wc -l | grep ^0"
        expected:
          - 0
      6.2.13 Ensure users' .netrc Files are not group or world accessible - Level 1 Server (Scored):
        audit:
          - "/etc/system-audit/cis-benchmark-checks/6.2.12.sh | wc -l | grep ^0"
        expected:
          - 0
      6.2.14 Ensure no users have .rhosts files - Level 1 Server (Scored):
        audit:
          - "/etc/system-audit/cis-benchmark-checks/6.2.14.sh | wc -l | grep ^0"
        expected:
          - 0
      6.2.15 Ensure all groups in /etc/passwd exist in /etc/group - Level 1 Server (Scored):
        audit:
          - "/etc/system-audit/cis-benchmark-checks/6.2.15.sh | wc -l | grep ^0"
        expected:
          - 0
      6.2.16 Ensure no duplicate UIDs exist - Level 1 Server (Scored):
        audit:
          - "/etc/system-audit/cis-benchmark-checks/6.2.16.sh | wc -l | grep ^0"
        expected:
          - 0
      6.2.17 Ensure no duplicate GIDs exist - Level 1 Server (Scored):
        audit:
          - "/etc/system-audit/cis-benchmark-checks/6.2.17.sh | wc -l | grep ^0"
        expected:
          - 0
      6.2.18 Ensure no duplicate user names exist - Level 1 Server (Scored):
        audit:
          - "/etc/system-audit/cis-benchmark-checks/6.2.18.sh | wc -l | grep ^0"
        expected:
          - 0
      6.2.19 Ensure no duplicate group names exist - Level 1 Server (Scored):
        audit:
          - "/etc/system-audit/cis-benchmark-checks/6.2.19.sh | wc -l | grep ^0"
        expected:
          - 0
